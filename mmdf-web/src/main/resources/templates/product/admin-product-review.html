<!doctype html>
<html xmlns:th="http://thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>員工商品管理系統</title>
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/img/favicon.ico">
    <!--css-->
    <!--    <th:block th:replace="~{/fragments/css}"/>-->
    <!-- CSS
 ========================= -->
    <!--bootstrap min css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/bootstrap.min.css">
    <!--owl carousel min css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/owl.carousel.min.css">
    <!--slick min css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/slick.css">
    <!--magnific popup min css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/magnific-popup.css">
    <!--font awesome css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/font.awesome.css">
    <!--ionicons min css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/ionicons.min.css">
    <!--animate css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/animate.css">
    <!--jquery ui min css-->
    <!--    <link rel="stylesheet" href="/assets/FrontEnd0516/css/jquery-ui.min.css">-->
    <!--slinky menu css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/slinky.menu.css">
    <!--plugins css-->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/plugins.css">

    <!-- Main Style CSS -->
    <link rel="stylesheet" href="/assets/FrontEnd0516/css/style.css">

    <!-- add member css-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

    <script th:src="@{/js/custom.js}"></script>

    <script src="/js/api-response-utils.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        /* 樣式設置 */
        .tab-container {
            border-bottom: 1px solid #ccc;
            display: flex;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid transparent;
            border-bottom: none;
            background-color: white;
        }

        .tab.active {
            border-color: white;
        }

        .tab-content {
            display: none;
            padding: 20px;
            border: 1px solid #ccc;
            border-top: none;
            width: 100%;
        }

        .tab-content.active {
            display: block;
        }
    </style>

</head>
<body>
<!--header-->
<th:block th:replace="~{/fragments/header}"/>

<!--breadcrumb-->
<!--<th:block th:replace="~{/fragments/breadcrumb}"/>-->


<td width=548 align=center valign=top>
    <!-- 导航 -->
    <TABLE WIDTH=548 BORDER=0 CELLPADDING=0 CELLSPACING=0>
        <!-- 標籤容器 -->
        <div class="tab-container">
            <!-- 初始的標籤 -->
            <div class="tab" onclick="showTabContent('new')">內部公告</div>
            <div class="tab" onclick="showTabContent('star')">客戶評價</div>
            <div class="tab" onclick="showTabContent('assess')">業績</div>
            <div class="tab" onclick="showTabContent('supplier')">供應商</div>
        </div>

        <!-- 標籤內容 -->
        <div id="new" class="tab-content">
            <h3><strong>公告:</strong></h3>
            <p>親愛的員工，<br>
                &nbsp &nbsp &nbsp &nbsp 我們很高興地宣布，我們的二手商城將推出一項新的政策，旨在提升我們的服務品質並保護我們的客戶和員工。<br>

                從即日起，所有上架的二手商品都必須通過我們的質量檢查。這意味著，每一項商品在上架前，都需要經過我們的專業團隊進行詳細的檢查，以確保商品的品質符合我們的標準。

                此外，我們也將實施新的退貨政策。如果客戶在購買商品後的30天內發現商品有任何問題，他們可以申請退貨或換貨。我們的客服團隊將會在收到申請後的48小時內回覆。

                &nbsp 我們相信，這些新政策將有助於提升我們的服務品質，並贏得客戶的信任。我們期待你們的支持和配合，一起為我們的客戶提供更好的服務。<br>

                感謝你們的理解和配合。<br><br>

                敬祝各位同仁 &nbsp MMDF商城</p>
        </div>
        <div id="star" class="tab-content">
            <h3>客戶評價</h3>
            <ul style="list-style-type: none; padding: 0;">
                <li style="display: inline-block;"><a href="#"><i class="icon icon-Star" style="color: orange;"></i></a>
                </li>
                <li style="display: inline-block;"><a href="#"><i class="icon icon-Star" style="color: orange;"></i></a>
                </li>
                <li style="display: inline-block;"><a href="#"><i class="icon icon-Star" style="color: orange;"></i></a>
                </li>
                <li style="display: inline-block;"><a href="#"><i class="icon icon-Star" style="color: orange;"></i></a>
                </li>
                <li style="display: inline-block;"><a href="#"><i class="icon icon-Star"></i></a></li>
            </ul>
        </div>
        <div id="assess" class="tab-content">
            <h3>季度報表 (2020-2024)</h3>
            <canvas id="myChart"></canvas>
        </div>
        <div id="supplier" class="tab-content">
            <h4>各部門分機:</h4>
            <pre>
                客服部門：            行銷部門：
                張小姐：分機101       黃先生：分機401
                李先生：分機102       高小姐：分機402
                王小姐：分機103       吳小姐：分機403
                採購部門：            陳小姐：分機404
                陳先生：分機201       物流部門：
                林小姐：分機202       鄭先生：分機301
                                  &nbsp  蔡小姐：分機302
            </pre>
        </div>
    </table>
</td>


<!--shop  area start-->
<div class="shop_area shop_reverse mt-100 mb-100">
    <div class="container">
        <div class="row">
            <div class="col-lg-1 col-md-12">
                <!--                    0515start-->
                <button type="button" class="btn btn-success " data-toggle="modal"
                        data-target="#searchModal" id="search">
                    搜索清單
                </button>
            </div>
        </div>

        <!-- Navigation -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark static-top">
            <div class="container">
                <a class="navbar-brand" href="/">商品資料</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse"
                        data-target="#navbarResponsive"
                        aria-controls="navbarResponsive"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
        </nav>

        <div class="container">
            <div class="row">
                <div class="col-lg-12 mt-5 mb-5">
                    <table id="products" class="table table-bordered table-responsive-sm">
                        <colgroup>
                            <!-- 第一欄寬度 -->
                            <col style="width: 3%;">
                            <!-- 第二欄寬度 -->
                            <col style="width: 5%;">
                            <!-- 第三欄寬度 -->
                            <col style="width: 20%;">
                            <!-- 第四欄寬度 -->
                            <col style="width: 30%;">
                            <!-- 第五欄寬度 -->
                            <col style="width: 5%;">
                            <!-- 第六欄寬度 -->
                            <col style="width: 2%;">
                            <!-- 第七欄寬度 -->
                            <col style="width: 35%;">
                            <!-- 第八欄寬度 -->
                            <col style="width: 3%;">
                            <!-- 第九欄寬度 -->
                            <col style="width: 5%;">
                            <!-- 第十欄寬度 -->
                            <col style="width: 5%;">
                            <!-- 第十一欄寬度 -->
                            <col style="width: 10%;">
                        </colgroup>
                        <thead>
                        <tr>
                            <th>編號</th>
                            <th>分類</th>
                            <th>品<br>名</th>
                            <th>內<br>容</th>
                            <th>價<br>格</th>
                            <th>數<br>量</th>
                            <th>圖<br>片</th>
                            <th>賣家編號</th>
                            <th>審核狀態</th>
                            <th>上下架</th>
                            <th>審<br>核</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="product : ${productPage.content}">
                            <td th:text="${product.productId}">1</td>
                            <td th:text="${product.productCategoryEntity.categoryName}">
                            </td>
                            <td th:text="${product.name.length() > 5 ? #strings.substring(product.name, 0, 5) + '...' : product.name}">
                                name
                            </td>
                            <td th:text="${product.description}">0.00</td>
                            <td th:text="${product.price}">0.00</td>
                            <td th:text="${product.quantity}">0.00</td>

                            <td th:if="${product.productImgs != null and product.productImgs.size() > 0}"
                                th:id="'productImgTd_' + ${product.productImgs[0].imageId}">
                                <img th:src="'data:image/jpg;base64,'+${product.productImgs[0].imageBase64}"
                                     style="height: 120px;width: 120px" alt=""/>
                            </td>
                            <td th:if="${product.productImgs == null or product.productImgs.size() == 0}"></td>

                            <td th:text="${product.sellerId}">1</td>

                            <td th:utext="${reviewStatusList.containsKey(product.reviewStatus) ? reviewStatusList[product.reviewStatus] : '審核中'}">
                                0.00
                            </td>
                            <td th:utext="${productStatusList.containsKey(product.productStatus) ? productStatusList[product.productStatus] : '默認'}">
                                0.00
                            </td>
                            <td>
                                <!--                                <button onclick="updateReviewStatus(${product.productId})" class="btn btn-primary">-->
                                <!--                                    審核成功-->
                                <!--                                </button>-->
                                <!--                                <button onclick="updateReviewStatus('${product.productId}')" class="btn btn-primary">審核成功</button>-->
                                <!--                                <button class="btn btn-primary" data-product-id="${product.productId}">-->
                                <!--                                    審核成功-->
                                <!--                                </button>-->
                                <button class="btn btn-primary" th:attr="data-product-id=${product.productId}">
                                    審核成功
                                </button>

                            </td>

                        </tr>
                        </tbody>
                    </table>

                    <nav>
                        <ul class="pagination">
                            <li class="page-item"
                                th:classappend="${productPage.hasPrevious()} ? '' : 'disabled'">
                                <a class="page-link"
                                   th:href="@{/admin/product/review(page=${productPage.number - 1}, size=${productPage.size})}">Previous</a>
                            </li>
                            <li class="page-item"
                                th:each="i : ${#numbers.sequence(0, productPage.totalPages - 1)}"
                                th:classappend="${productPage.number == i} ? 'active'">
                                <a class="page-link"
                                   th:href="@{/admin/product/review(page=${i}, size=${productPage.size})}"
                                   th:text="${i + 1}">1</a>
                            </li>
                            <li class="page-item" th:classappend="${productPage.hasNext()} ? '' : 'disabled'">
                                <a class="page-link"
                                   th:href="@{/admin/product/review(page=${productPage.number + 1}, size=${productPage.size})}">Next</a>
                            </li>
                            <li class="page-item">
                                <form th:action="@{/admin/product/review}" method="get">
                                    <input type="hidden" name="size" th:value="${productPage.size}">
                                    <input type="number" name="page" min="0" max="${productPage.totalPages - 1}"
                                           step="1" value="${productPage.number}" style="width: 50px;">
                                    <button type="submit" class="btn btn-primary">Go</button>
                                </form>
                            </li>
                        </ul>
                    </nav>

                </div>
            </div>
        </div>
    </div>
</div>
<!--                    0515end-->
<!--shop  area end-->
<script src="/js/vendor/jquery-3.7.1.min.js"></script>
<script>
    $(document).ready(function () {
        $('button.btn').click(function () {
            var productId = $(this).data('product-id');
            updateReviewStatus(productId);
            console.log(productId);
        });
    });

    function updateReviewStatus(productId) {
        $.ajax({
            type: "POST",
            url: "/seller/product/updateReviewStatus/" + productId,
            data: JSON.stringify({productId: productId}),
            headers: {
                "authorization": localStorage.getItem("authorization")
            },
            contentType: "application/json", // 設置請求頭的 Content-Type
            success: function (response) {
                // success(response) {
                apiResponseJSON(response, {
                    // onSuccess(data) {
                    onSuccess: (data) => {
                        console.log(data);
                        // 检查 data 中是否有 reviewStatus
                        if (response.hasOwnProperty("reviewStatus")) {
                            $('#reviewStatus' + productId).text(response.reviewStatus);
                        }
                        console.log(response.success || response.error);
                    }
                });
            },
            error: function (xhr, status, error) {
                console.error(xhr.responseText);
            }
        });
    }


    // 函數：顯示特定標籤的內容
    function showTabContent(tabName) {
        // 隱藏所有標籤內容
        var tabContents = document.querySelectorAll('.tab-content');
        tabContents.forEach(function (content) {
            content.classList.remove('active');
        });

        // 顯示選定標籤的內容
        var selectedTabContent = document.getElementById(tabName);
        selectedTabContent.classList.add('active');

        // 取消選定所有標籤
        var tabs = document.querySelectorAll('.tab');
        tabs.forEach(function (tab) {
            tab.classList.remove('active');
        });

        // 選定並突顯選定標籤
        var selectedTab = document.querySelector('[onclick="showTabContent(\'' + tabName + '\')"]');
        selectedTab.classList.add('active');
    }

    var ctx = document.getElementById('myChart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: ['一月到三月', '四月到六月', '七月到九月', '十月到十二月'],
            datasets: [
                {
                    label: '2020',
                    data: [192, 330, 240, 108],
                    borderColor: 'rgba(255, 99, 132, 1)',
                    fill: false
                },
                {
                    label: '2021',
                    data: [260, 370, 284, 220],
                    borderColor: 'rgba(54, 162, 235, 1)',
                    fill: false
                },
                {
                    label: '2022',
                    data: [280, 306, 120, 230],
                    borderColor: 'rgba(255, 206, 86, 1)',
                    fill: false
                },
                {
                    label: '2023',
                    data: [240, 150, 328, 270],
                    borderColor: 'rgba(75, 192, 192, 1)',
                    fill: false
                },
                {
                    label: '2024',
                    data: [284, 220, 192, 350],
                    borderColor: 'rgba(153, 102, 255, 1)',
                    fill: false
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
    });


    // $.ajax({
    //     type: "POST",
    //     url: "/seller/product/updateReviewStatus",
    //     data: postData,
    //     success: function(response) {
    //         apiResponseJSON(response, {
    //             onSuccess: function(data) {
    //                 // 成功回调函数
    //                 console.log("Success:", data);
    //             },
    //             onError: function(error) {
    //                 // 错误回调函数
    //                 console.error("Error:", error);
    //             }
    //         });
    //     },
    //     error: function(xhr, status, error) {
    //         // AJAX 请求失败时的处理
    //         console.error("AJAX Error:", error);
    //     }
    // });

</script>


<!--footer-->
<th:block th:replace="~{/fragments/footer}"/>

<!--js-->
<th:block th:replace="~{/fragments/js}"/>

</body>
</html>